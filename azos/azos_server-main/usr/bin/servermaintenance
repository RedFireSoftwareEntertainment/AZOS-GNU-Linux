#!/bin/bash

# Licenced under the GNU GPL 3.0
# Part of AZOS GNU/Linux and all legal information from this legal page apply here: https://sites.google.com/view/azosofficialsite/legal

# Simple tool for AZOS GNU/Linux Server maintenance.

main(){
    echo "Welcome to 'servermaintenance'"
    echo "A tool designed to make performing AZOS GNU/Linux Server tasks a bit easier."
    echo ""
    echo "TIP: Do not update your server often, and only do when it is absolutely neccessary."
    echo "     We recommend you check https://archlinux.org/ in the news section for bad updates"
    echo "     or updates that may require manual intervention"
    echo ""
    echo "Select the action you want to perform by typing the number inside the () corresponding to the action:"
    echo ""
    echo "(1) Sync repos listed in /etc/pacman.conf"
    echo "(2) System upgrade (Will also sync repos)"
    echo "(3) (Re)Install archlinux-keyring (Will also sync repos)"
    echo ""
    read -p "Action: " action
}

serror(){
   clear
   echo ""
   echo "Syntax Error: Action not found"
   echo ""
   main
}

syncrepos(){
   clear
   echo "Syncing repos..."
   sudo pacman -Sy
   clear
   main
}

upgrade(){
   clear
   echo "Starting upgrade..."
   sudo pacman -Syu
   clear
   main
}

keyring(){
   clear
   echo "Keyring..."
   sudo pacman -Sy archlinux-keyring
   clear
   main
}

clear
echo ""
main

if [ "$action" == 1 ]; then
    syncrepos
elif [ "$action" == 2 ]; then
    upgrade
elif [ "$action" == 3 ]; then
    keyring
else
    serror
fi


